<!DOCTYPE html>
<html  lang="en">
<head lang="en">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>BAS Join</title>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

  <!-- JQuery library -->
  <script type="text/javascript" src="/javascript_files/jquery-1.11.3.js"></script>

  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

  <!-- JQuery form actions -->
  <script type="text/javascript" src="/javascript_files/jquery.validate.js"></script>
  <script type="text/javascript" language="javascript">
    $(document).ready(function() {
        var signup_form = $("#signup");

        signup_form.submit(function (event) {
          signup_form.validate({
            rules: {
              full_name: "required",
              spoogler_email: {
                required: true,
                email: true
              },
              spoogler_fb_email: "email",
              googler_ldap: "required",
            },
            messages:{
              full_name: "Please enter the Spoogler's full name",
              spoogler_email: {
                required: "Please enter the Spoogler's email",
                email: "Please enter a valid email"
              },
              googler_ldap: "Please enter the Googler's ldap"
            },
          });

          if(signup_form.valid()) {
            signup_form.unbind('submit').submit();
            return;
          }

          $("html, body").animate({ scrollTop: 0}, 500);
          event.preventDefault();
          return false;
        });

        var address = $("#address")
        var other_address = $("#other_address")
        other_address.hide();
        address.change(function() {
          if($("#address option:selected").text() == "Other") {
            other_address.show();
          } else {
            other_address.hide();
            other_address.val("");
          }
        });

        var native_lang = $("#native_lang")
        var other_native_lang = $("#native_lang_other")
        other_native_lang.hide();
        native_lang.change(function() {
          if($("#native_lang option:selected").text() == "Other") {
            other_native_lang.show();
          } else {
            other_native_lang.hide();
            other_native_lang.val("");
          }
        });

    });
  </script>

  <!-- Text color for the errors detected through the JQuery validation plugin -->
  <style>
  .error {
      color:red;
  }
  </style>

</head>
<body {% if successful_submission %}onload="showAlert()"{% endif %}>
  <div class="container">  
    <h1>Request to join the Bay Area Spooglers Group</h1>
    <p>Welcome, {{ user.email() }}!
    You can <a href="{{ logout_url }}"> sign out</a>.</p>
    <p>This form is for partners/spouses of Googlers who have recently 
    relocated to the Bay Area.</p>
    <p>Please fill in the information below if you are interested in joining 
    the Bay Area Spooglers Group to connect with other Spooglers. You will be 
    added to the group once your information is verified.</p>
    <p>Many of the group's activities are planned based on your response to 
    this form.</p>
    
    <p><b>* Required</b></p>
    
    {% if not valid_form %}
        <p style="color:red"><b>There are errors in the form.</b></p>
        {% if spoogler_email_duplicate %}
            <p style="color:red">Spoogler email address already exists.</p>
        {% endif %}
        {% if ldap_at_sign_error %}
            <p style="color:red">Please write the Googler's ldap without the "@google.com".</p>
        {% endif %}
        {% if googler_ldap_error and googler_ldap_duplicate %}
            <p style="color:red">Googler's ldap already exists. If you are trying with the correct Googler's ldap and still receive this message, contact us: bayareaspooglers.webmaster@gmail.com</p>
        {% endif %}
    {% endif %}
    

  <form action="" method="post" id="signup">
    {% include 'form.html' %}
    <div class="col-md-12 text-center">
      <button type="submit" class="btn btn-lg btn-primary" id="submit">Submit</button>
    </div>
  </form>
  </div>
  
  <script type="text/javascript" language="javascript">
    function showAlert() {
        alert("Thank you for filling out the membership form. A confirmation email has been sent to {{confirmation_ldap}}@google.com");
    }
  </script>
  
</body>
</html>
